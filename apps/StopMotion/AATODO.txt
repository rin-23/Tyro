1. make S and G matricies in updateStep.cpp sparse
2. replace smooth and data functions with matricies in labeling